
```{r setup, include=FALSE, echo=FALSE }
library(knitr)
opts_chunk$set(echo=FALSE, 
	       message=FALSE, 
	       warning=FALSE,
	       comment=NA)
```



```{r ll  }
library(tidyverse)
library(tidyquant)
library(pander)
```


```{r rp  }
load("./RDATA/rice_td3.RData")

```

# Rice price

## Last five years

```{r lf  }
rice.td3 %>% 
    filter(year(yrmon) > 2011) %>% 
    ggplot(aes(x=yrmon, y=amount))+
	geom_line()
```




## Last two years

```{r lf2  }
rice.td3 %>% 
    filter(year(yrmon) > 2013) %>% 
    ggplot(aes(x=yrmon, y=amount))+
	geom_line()
```


## Top 10 prices

In the below we see  top 10 prices in the last two decades in Bangladesh (wholesale coarse price). We find that out of this top 10 prices, 5 of those were registered in 2017. Two were recorded in 2016, October and November repectively. 


```{r top10p  }
rice.td3 %>% 
    arrange(desc(amount)) %>% 
    slice(1:10) %>% 
    data.frame() %>% 
    pander()
```

let's put it into graph


```{r top10pGr  }

rice.td3 %>% 
    arrange(desc(amount)) %>% 
    slice(1:10) %>% 
    mutate(yrmon=as.factor(yrmon)) %>% 
    ggplot(aes(x=reorder(yrmon,amount),y=amount,fill=amount))+
      geom_bar(stat="identity") +
      coord_flip()
```





In the same manner we look into to 10 lowest prices in last two decades


```{r top10low2  }
rice.td3 %>% 
    arrange(amount) %>% 
    slice(1:10) %>% 
    data.frame() %>% 
    pander()
```

In the above see that, all were back in later half of 1990s

let's try in the last 10 years

```{r top10low10  }
rice.td3 %>% 
    filter(year(yrmon) > 2007) %>% 
    arrange(amount) %>% 
    slice(1:10) %>% 
    data.frame() %>% 
    pander()
```


We find that all were recorded back in 2009

how about last 5 years

```{r top10low05  }
rice.td3 %>% 
    filter(year(yrmon) > 2011) %>% 
    arrange(amount) %>% 
    slice(1:10) %>% 
    data.frame() %>% 
    pander()
```


in the above we see that in the last 5 years, 2nd lowest price was achived in May 2016. There is  2nd lowest price was achived in May 2016. There is two other prices from 2016. All others from 2012. 


From the above analysis we see that, in 2016 we saw lowest domestic rice prices in last five years and also saw highest prices in last 5 years or 10 years. This fluctuation seems to be difficult to explain at this moment. 


## Yearly price trend

```{r ypt  }
rice.td3 %>% 
    filter(year(yrmon) > 2011) %>% 
    mutate(mo=month(yrmon),yr=year(yrmon)) %>% 
    ggplot(aes(x=mo,y=amount)) +
	    geom_line() +
		facet_wrap(~yr, ncol=2)
```

# International price

```{r lip  }
load("./RDATA/int_price_11_17.RData")
load("./RDATA/int_price_fpmu_mo2.RData")
```

## Bangladesh Bank Source (Thai price)

### Last five years

```{r bbt3  }
int.price.11.17 %>% 
    filter(year(yrmon) > 2011) %>% 
    ggplot(aes(x=yrmon,y=rice2)) +
	geom_line()
```

### last two years

```{r bbt2  }
int.price.11.17 %>% 
    filter(year(yrmon) > 2013) %>% 
    ggplot(aes(x=yrmon,y=rice2)) +
	geom_line()
```


### yearly trend

```{r ypt7 }
int.price.11.17 %>% 
    filter(year(yrmon) > 2011) %>% 
    mutate(mo=month(yrmon),yr=year(yrmon)) %>% 
    ggplot(aes(x=mo,y=rice2)) +
	    geom_line() +
		facet_wrap(~yr, ncol=2)
```


## Vietnam price

### Last five years

```{r bbt5  }
int.price.fpmu.mo2 %>% 
    filter(year(time) > 2011) %>% 
    ggplot(aes(x=time,y=vietnam.rice)) +
	geom_line()
```

### last two years

```{r bbt6  }
int.price.fpmu.mo2 %>% 
    filter(year(time) > 2013) %>% 
    ggplot(aes(x=time,y=vietnam.rice)) +
	geom_line()

```


### Top 10 prices

In the below we see  top 10 prices since 2009 in vietnam price. We find that out of this top 10 prices, almost all of those were recorded in 2011. 


```{r top10p2  }
int.price.fpmu.mo2 %>% 
    arrange(desc(vietnam.rice)) %>% 
    slice(1:10) %>% 
    select(time,vietnam.rice) %>% 
    data.frame() %>% 
    pander()
```

In the same manner we look into to 10 lowest prices since 2009


```{r top10low  }
int.price.fpmu.mo2 %>% 
    arrange(vietnam.rice) %>% 
    slice(1:10) %>% 
    select(time,vietnam.rice) %>% 
    data.frame() %>% 
    pander()
```

What we see is quite interesting. since 2009, the lowest prices were recorded in 2015, 2016 and 2017. As of April
2017, we have the 10-th lowest price since 2009. 

## Thai price

### Top 10 prices

In the below we see  top 10 prices since 2009 in vietnam price. We find that out of this top 10 prices, almost all of those were recorded in in the period between 2009 and 2011. 


```{r top10pth  }
int.price.fpmu.mo2 %>% 
    arrange(desc(thai.rice1)) %>% 
    slice(1:10) %>% 
    select(time,thai.rice1) %>% 
    data.frame() %>% 
    pander()
```

In the same manner we look into to 10 lowest prices since 2009


```{r top10lowth  }
int.price.fpmu.mo2 %>% 
    arrange(thai.rice1) %>% 
    slice(1:10) %>% 
    select(time,thai.rice1) %>% 
    data.frame() %>% 
    pander()
```

What we see is quite interesting. since 2009, the lowest prices were recorded in 2015, 2016 and 2017. As of March 2017, we have the 9-th lowest price since 2009. 




### yearly trend

```{r ypt2  }
int.price.fpmu.mo2 %>% 
    filter(year(time) > 2011) %>% 
    mutate(mo=month(time),yr=year(time)) %>% 
    ggplot(aes(x=mo,y=vietnam.rice)) +
	    geom_line() +
		facet_wrap(~yr, ncol=2)
```

# Public stock of rice


```{r psr  }
load("./RDATA/rice_pub_cl_mo.RData")
```



## Last five years

```{r ps50  }
rice.pub.cl.mo %>% 
    filter(year(yrmon) > 2011) %>% 
    ggplot(aes(x=yrmon, y=amount))+
	geom_line()
```

## Last two years

```{r ps3  }
rice.pub.cl.mo %>% 
    filter(year(yrmon) > 2013) %>% 
    ggplot(aes(x=yrmon, y=amount))+
	geom_line()
```

### Top 10 stock values

In the below we 10 highest  public stock value of rice since 1990. We find that the latest highest was achieved in August 2015.

```{r top10st }
rice.pub.cl.mo %>% 
    arrange(desc(amount)) %>% 
    slice(1:10) %>% 
    data.frame() %>% 
    pander()
```

In the same manner we look into to 10 lowest  stock values since 1990


```{r top10lowst  }
rice.pub.cl.mo %>% 
    arrange(amount) %>% 
    slice(1:10) %>% 
    data.frame() %>% 
    pander()
```

In the above we find that in the last 27 years, we did not experience any low stock values that could feature into to 10 lowest. Now let's look into last 10 years


```{r top10lowst10  }
rice.pub.cl.mo %>% 
    filter(year(yrmon) > 2006) %>% 
    arrange(amount) %>% 
    slice(1:10) %>% 
    data.frame() %>% 
    pander()
```

what we see that we have the lowest public stock in 2017, particularly in June in last 10 years. 


## Yearly trend

```{r ypt3  }
rice.pub.cl.mo %>% 
    filter(year(yrmon) > 2011) %>% 
    mutate(mo=month(yrmon),yr=year(yrmon)) %>% 
    ggplot(aes(x=mo,y=amount)) +
	    geom_line() +
		facet_wrap(~yr, ncol=2)
```

# Import data

```{r pilf  }
load("./RDATA/rice_yr_imp.RData")
```

## Total national import


### Last five years

```{r ps62  }
rice.yr.imp %>% 
    ggplot(aes(x=FY, y=total.national.imp))+
	geom_line(group="")
```

###  Last two years

```{r ps4  }
rice.yr.imp %>% 
    filter(FY %in%  c("FY13","FY14","FY15","FY16","FY17"))  %>% 
    ggplot(aes(x=FY, y=total.national.imp))+
	geom_line(group="")
```


## Total rice import


### Last five years

```{r ps7  }
rice.yr.imp %>% 
    ggplot(aes(x=FY, y=rice.national.imp))+
	geom_line(group="")
```

###  Last two years

```{r ps53  }
rice.yr.imp %>% 
    filter(FY %in%  c("FY13","FY14","FY15","FY16","FY17"))  %>% 
    ggplot(aes(x=FY, y=rice.national.imp))+
	geom_line(group="")
```

## Private rice import


###  All the years

```{r ps8  }
rice.yr.imp %>% 
    ggplot(aes(x=FY, y=rice.pri.imp))+
	geom_line(group="") + 
	theme(axis.text.x=element_text(angle=90))
```

###  Last five years

```{r ps59  }
rice.yr.imp %>% 
    filter(FY %in%  c("FY13","FY14","FY15","FY16","FY17"))  %>% 
    ggplot(aes(x=FY, y=rice.pri.imp))+
	geom_line(group="")
```

## Public rice import


###  All the years

```{r ps1  }
rice.yr.imp %>% 
    ggplot(aes(x=FY, y=rice.tot.gob.imp))+
	geom_line(group="") + 
	theme(axis.text.x=element_text(angle=90))
```

###  Last five years

```{r ps61  }
rice.yr.imp %>% 
    filter(FY %in%  c("FY13","FY14","FY15","FY16","FY17"))  %>% 
    ggplot(aes(x=FY, y=rice.tot.gob.imp))+
	geom_line(group="")
```

# Government procurement of rice

```{r procl  }
load("./RDATA/rice_proc_mo_td2.RData")
rice.proc.mo.td2  <-  rice.proc.mo.td2 %>% 
			    filter(!is.na(amount))
```

## Last five years

```{r ps51  }
rice.proc.mo.td2 %>% 
    filter(year(yrmon) > 2011) %>% 
    ggplot(aes(x=yrmon, y=amount))+
	geom_line()
```

## Last two years

```{r p77  }
rice.proc.mo.td2 %>% 
    filter(year(yrmon) > 2013) %>% 
    ggplot(aes(x=yrmon, y=amount))+
	geom_line()
```




## Yearly trend

```{r ypt4  }
rice.proc.mo.td2 %>% 
    filter(year(yrmon) > 2011) %>% 
    mutate(mo=month(yrmon),yr=year(yrmon)) %>% 
    ggplot(aes(x=mo,y=amount)) +
	    geom_line() +
		facet_wrap(~yr, ncol=2)
```

## Year-wise procurement upto August

```{r ypty  }
rice.proc.mo.td2 %>% 
    filter(year(yrmon) > 2011) %>% 
    group_by(year=year(yrmon)) %>% 
    filter(month(yrmon) < 9) %>% 
    summarize(total=sum(amount)) %>% 
    ggplot(aes(x=year,y=total)) +
	    geom_line() 
```


